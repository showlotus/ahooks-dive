---
title: Components
description: Some builtin components
---

# [useDebounceEffect](https://ahooks.js.org/zh-CN/hooks/use-debounce-effect#usedebounceeffect)

## ğŸ“– ç”¨æ³•

ç”¨æ¥å¤„ç†é˜²æŠ–å‰¯ä½œç”¨çš„ Hookã€‚

<ViewCode src="./use-debounce-effect/demo.tsx" />

## ğŸ“„ [æºç ](https://github.com/alibaba/hooks/blob/master/packages/hooks/src/useDebounceEffect/index.ts)

::: code-group

{/* prettier-ignore */}
```ts [useDebounceEffect.ts]
import { useEffect, useState } from 'react';
import type { DependencyList, EffectCallback } from 'react';
import type { DebounceOptions } from '../useDebounce/debounceOptions';
import useDebounceFn from '../useDebounceFn';
import useUpdateEffect from '../useUpdateEffect';

function useDebounceEffect(
  effect: EffectCallback,
  deps?: DependencyList,
  options?: DebounceOptions,
) {
  const [flag, setFlag] = useState({});

  const { run } = useDebounceFn(() => {
    setFlag({});
  }, options);

  useEffect(() => {
    return run();
  }, deps);

  useUpdateEffect(effect, [flag]);
}

export default useDebounceEffect;
```

:::

## ğŸ” è§£è¯»

::: tip
å…³äº `useDebounceFn`ã€`useUpdateEffect`ï¼Œå¯ä»¥æŸ¥çœ‹å¯¹åº”æ–‡æ¡£ï¼š[useDebounceFn](../../effect/use-debounce-fn/)ã€[useUpdateEffect](../../effect/use-update-effect/)ã€‚
:::

{/* prettier-ignore */}
```ts
function useDebounceEffect(
  effect: EffectCallback,
  deps?: DependencyList,
  options?: DebounceOptions,
) {
  // 1. é¦–å…ˆï¼Œä½¿ç”¨ useState å®šä¹‰äº†ä¸€ä¸ª flag çŠ¶æ€ï¼Œç”¨äºè®°å½•ä¾èµ–æ˜¯å¦æ›´æ–°ã€‚
  const [flag, setFlag] = useState({});

  // 2. ç„¶åï¼Œä½¿ç”¨ useDebounceFn æ¥å¤„ç†é˜²æŠ–å€¼ã€‚
  const { run } = useDebounceFn(() => {
    setFlag({});
  }, options);

  // 3. æ¥ç€ï¼Œä½¿ç”¨ useEffect æ¥ç›‘å¬ä¾èµ–çš„æ›´æ–°ï¼Œå¹¶è°ƒç”¨ run å‡½æ•°æ¥æ›´æ–°é˜²æŠ–å€¼ã€‚
  useEffect(() => {
    return run();
  }, deps);

  // 4. æœ€åï¼Œä½¿ç”¨ useUpdateEffect æ¥ç›‘å¬ flag çš„å˜åŒ–ï¼Œå¹¶æ‰§è¡Œ effectã€‚
  useUpdateEffect(effect, [flag]);
}
```

æ‰§è¡Œæµç¨‹ï¼š`deps` æ›´æ–° -> æ‰§è¡Œ `run` å‡½æ•° -> `flag` æ›´æ–° -> æ‰§è¡Œ `effect`ã€‚

ç”±äº `useUpdateEffect` ä¼šå¿½ç•¥é¦–æ¬¡æ‰§è¡Œï¼Œå¦‚æœéœ€è¦é¦–æ¬¡æ‰§è¡Œï¼Œå¯ä»¥é€šè¿‡ `useDebounceFn` çš„ `options` å‚æ•°æ¥è®¾ç½®ã€‚

```ts
const { run } = useDebounceFn(
  () => {
    setFlag({})
  },
  {
    wait: 1000,
    // è®¾ç½®ä¸º trueï¼Œè¡¨ç¤ºåœ¨å»¶è¿Ÿå¼€å§‹å‰è°ƒç”¨
    leading: true, // [!code highlight]
  },
)
```
