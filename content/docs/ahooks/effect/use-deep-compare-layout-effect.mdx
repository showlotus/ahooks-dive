---
title: Components
description: Some builtin components
---

# [useDeepCompareLayoutEffect](https://ahooks.js.org/zh-CN/hooks/use-deep-compare-layout-effect#usedeepcomparelayouteffect)

## ğŸ“– ç”¨æ³•

ç”¨æ³•ä¸ `useLayoutEffect` ä¸€è‡´ï¼Œä¸åŒçš„æ˜¯ï¼Œä¼šæ·±åº¦æ¯”è¾ƒä¾èµ–ã€‚

<ViewCode src="./use-deep-compare-layout-effect/demo.tsx" />

## ğŸ“„ [æºç ](https://github.com/alibaba/hooks/blob/master/packages/hooks/src/useDeepCompareLayoutEffect/index.tsx)

::: code-group

{/* prettier-ignore */}
```ts [useDeepCompareLayoutEffect.ts]
import { useLayoutEffect } from 'react';
import { createDeepCompareEffect } from '../createDeepCompareEffect';

export default createDeepCompareEffect(useLayoutEffect);
```

{/* prettier-ignore */}
```ts [createDeepCompareEffect.ts]
import { useRef } from 'react';
import type { DependencyList, useEffect, useLayoutEffect } from 'react';
import { depsEqual } from '../utils/depsEqual';

type EffectHookType = typeof useEffect | typeof useLayoutEffect;

type CreateUpdateEffect = (hook: EffectHookType) => EffectHookType;

export const createDeepCompareEffect: CreateUpdateEffect = (hook) => (effect, deps) => {
  const ref = useRef<DependencyList>(undefined);
  const signalRef = useRef<number>(0);
  if (deps === undefined || !depsEqual(deps, ref.current)) {
    signalRef.current += 1;
  }
  ref.current = deps;
  hook(effect, [signalRef.current]);
};
```

{/* prettier-ignore */}
```ts [depsEqual.ts]
import type { DependencyList } from 'react';
import isEqual from 'react-fast-compare';

export const depsEqual = (aDeps: DependencyList = [], bDeps: DependencyList = []) =>
  isEqual(aDeps, bDeps);
```

:::

## ğŸ” è§£è¯»

å…³äº `createDeepCompareEffect` çš„è§£è¯»ï¼Œå¯ä»¥æŸ¥çœ‹å¯¹åº”æ–‡æ¡£ï¼š[useDeepCompareEffect](../../effect/use-deep-compare-effect/#ğŸ”-è§£è¯»)ã€‚
