---
title: useLatest
description: Some builtin components
---

# [useLatest](https://ahooks.js.org/zh-CN/hooks/use-latest#uselatest)

## ğŸ“– ç”¨æ³•

è¿”å›æœ€æ–°çš„å€¼ã€‚

<ViewCode src="./use-latest/use-latest.tsx" />

ä¸ºä»€ä¹ˆ `demo.tsx` ä¸­ä¸ºä»€ä¹ˆ `defaultCount` æ²¡æœ‰æ›´æ–°ï¼Ÿ

è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„ React é—­åŒ…é—®é¢˜ï¼Œç”±äº `useEffect` åœ¨ç»„ä»¶æŒ‚è½½ååªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œä¸” `setInterval` ä¸­çš„å›è°ƒå‡½æ•°å†…éƒ¨å§‹ç»ˆæ˜¯å¯¹ç¬¬ä¸€æ¬¡åˆå§‹åŒ–æ—¶çš„ `defaultCount` è¿›è¡Œå¼•ç”¨ï¼Œä¹Ÿå°±æ„å‘³ç€ `setInterval` çš„å›è°ƒå‡½æ•°ä¸­è·å–åˆ°çš„ `defaultCount` ä¸€ç›´éƒ½æ˜¯ `0`ã€‚

å¦‚æœå°† `setDefaultCount` ä¼ å…¥ä¸€ä¸ªæ›´æ–°å‡½æ•°ï¼Œé‚£ä¹ˆå°±èƒ½è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

```mdx title="demo.tsx"
import { useState, useEffect } from 'react'

export default () => {
  const [defaultCount, setDefaultCount] = useState(0)

useEffect(() => {
const interval = setInterval(() => {
setDefaultCount(count => count + 1) // [!code highlight]
}, 1000)
return () => clearInterval(interval)
}, [])

return (

<>
  <p>count(default): {defaultCount}</p>
</>
) }
```

<ViewCode src="./use-latest/use-latest2.tsx" />

## ğŸ“„ [æºç ](https://github.com/alibaba/hooks/blob/master/packages/hooks/src/useLatest/index.ts)

{/* prettier-ignore */}
```ts title="useLatest.ts"
import { useRef } from 'react';

function useLatest<T>(value: T) {
  const ref = useRef(value);
  ref.current = value;

  return ref;
}

export default useLatest;
```

## ğŸ” è§£è¯»

ä½¿ç”¨ `useRef` å®šä¹‰ä¸€ä¸ª `ref` å¯¹è±¡ï¼Œå°†å…¥å‚èµ‹å€¼ç»™ `ref` å¯¹è±¡ï¼Œç„¶åè¿”å›è¿™ä¸ª `ref` å¯¹è±¡ã€‚ç›¸è¾ƒäº `useRef`ï¼Œå¤šäº†ä¸€è¡Œèµ‹å€¼çš„ä»£ç ï¼Œç¡®ä¿æ¯æ¬¡è·å–çš„å€¼éƒ½æ˜¯æœ€æ–°çš„


{/* prettier-ignore */}
```ts [useLatest.ts]
import { useRef } from 'react';

function useLatest<T>(value: T) {
  const ref = useRef(value);
  ref.current = value; // [!code highlight]

  return ref;
}

export default useLatest;
```

```tsx title="demo.tsx"
import { useState, useEffect, useRef } from 'react'
import { useLatest } from 'ahooks'

export default () => {
  const [useLatestCount, setUseLatestCount] = useState(0)
  const [defaultCount, setDefaultCount] = useState(0)

  const latestCountRef = useLatest(useLatestCount)

  useEffect(() => {
    const interval = setInterval(() => {
      setUseLatestCount(latestCountRef.current + 1)
    }, 1000)
    return () => clearInterval(interval)
  }, [])

  useEffect(() => {
    const interval = setInterval(() => {
      setDefaultCount(defaultCount + 1)
    }, 1000)
    return () => clearInterval(interval)
  }, [])

  return (
    <>
      <p>count(useLatest): {useLatestCount}</p>
      <p>count(default): {defaultCount}</p>
    </>
  )
}
```

å› ä¸ºä½¿ç”¨ `useRef` å®šä¹‰çš„å˜é‡ï¼ŒReact ä¼šè®°å½•åœ¨å½“å‰ç»„ä»¶å†…éƒ¨ï¼Œåœ¨ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶ï¼Œä¸ä¼šå†è¢«åˆå§‹åŒ–ï¼Œè€Œæ˜¯ä½¿ç”¨å½“å‰ç»„ä»¶å†…éƒ¨è®°å½•çš„å€¼ã€‚

è€Œæ¯æ¬¡é‡æ–°æ¸²æŸ“æ—¶ï¼Œå½“å‰ç»„ä»¶å†…éƒ¨ä¸Šä¸‹æ–‡ä¸­æ‹¿åˆ°çš„éƒ½æ˜¯æ¯ä¸ª `state` æœ€æ–°çš„å€¼ï¼Œ`useLatest` ç›¸å½“äºæ›´æ–°äº†ä¸€ä¸‹ `useRef` å®šä¹‰çš„å€¼ï¼Œä¿è¯å½“å‰ `ref` å¯¹è±¡æ˜¯æœ€æ–°çš„å€¼ã€‚

<ThemeImage
  light="./use-latest/use-latest.excalidraw.svg"
  dark="./use-latest/use-latest.dark.svg"
  alt="demo.tsx æ›´æ–°æµç¨‹"
/>
